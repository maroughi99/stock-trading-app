<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Day Trading Scanner</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        .header {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            margin-bottom: 30px;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .header h1 {
            color: #1e3c72;
            font-size: 2.5em;
            margin-bottom: 5px;
        }

        .header p {
            color: #666;
            font-size: 1.1em;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        .nav-btn {
            padding: 12px 25px;
            background: #1e3c72;
            color: white;
            border: none;
            border-radius: 10px;
            text-decoration: none;
            font-size: 14px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .nav-btn:hover {
            background: #2a5298;
        }

        .criteria {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .criteria h3 {
            margin-bottom: 10px;
            color: #333;
        }

        .criteria-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 10px;
        }

        .criteria-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #555;
        }

        .criteria-item::before {
            content: "‚úì";
            color: #28a745;
            font-weight: bold;
        }

        .controls {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .scan-btn {
            padding: 15px 40px;
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .scan-btn:hover {
            transform: scale(1.05);
        }

        .scan-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: scale(1);
        }

        .filter-buttons {
            display: flex;
            gap: 10px;
        }

        .filter-btn {
            padding: 10px 20px;
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .filter-btn.active {
            background: #1e3c72;
            color: white;
            border-color: #1e3c72;
        }

        .stats-bar {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            color: #1e3c72;
        }

        .stat-label {
            color: #666;
            margin-top: 5px;
        }

        .stocks-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stock-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.3s;
            animation: fadeIn 0.5s ease-out;
            position: relative;
            border-left: 5px solid;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .stock-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        .stock-card.hot {
            border-left-color: #dc3545;
            background: linear-gradient(135deg, #fff5f5, #ffffff);
        }

        .stock-card.warm {
            border-left-color: #ffc107;
            background: linear-gradient(135deg, #fffef5, #ffffff);
        }

        .stock-card.moderate {
            border-left-color: #28a745;
            background: linear-gradient(135deg, #f5fff5, #ffffff);
        }

        .stock-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .stock-symbol {
            font-size: 1.8em;
            font-weight: bold;
            color: #333;
        }

        .stock-name {
            font-size: 0.9em;
            color: #666;
            margin-top: 2px;
        }

        .heat-badge {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .heat-badge.hot {
            background: #dc3545;
            color: white;
        }

        .heat-badge.warm {
            background: #ffc107;
            color: #333;
        }

        .heat-badge.moderate {
            background: #28a745;
            color: white;
        }

        .stock-price {
            font-size: 2em;
            font-weight: bold;
            color: #333;
            margin: 10px 0;
        }

        .stock-change {
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .stock-change.positive {
            color: #28a745;
        }

        .stock-change.negative {
            color: #dc3545;
        }

        .metrics {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        .metric {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 8px;
        }

        .metric-label {
            font-size: 0.85em;
            color: #666;
            margin-bottom: 3px;
        }

        .metric-value {
            font-size: 1.1em;
            font-weight: 600;
            color: #333;
        }

        .signals {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e0e0e0;
        }

        .signals-title {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 8px;
        }

        .signal-tag {
            display: inline-block;
            padding: 4px 10px;
            margin: 3px;
            border-radius: 12px;
            font-size: 0.8em;
            background: #e3f2fd;
            color: #1976d2;
        }

        .loading {
            text-align: center;
            padding: 50px;
            color: white;
            font-size: 1.5em;
        }

        .spinner {
            border: 4px solid rgba(255,255,255,0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid #f5c6cb;
        }

        .empty-state {
            text-align: center;
            padding: 60px;
            color: white;
        }

        .empty-state h2 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        @media (max-width: 768px) {
            .stocks-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function DayTradingScanner() {
            const [stocks, setStocks] = useState([]);
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState(null);
            const [filter, setFilter] = useState('all');

            // Day trading watchlist - High volume, volatile stocks
            const dayTradingWatchlist = [
                // Mega cap tech - High volume
                'AAPL', 'MSFT', 'GOOGL', 'AMZN', 'NVDA', 'TSLA', 'META',
                // Popular day trading stocks
                'AMD', 'PLTR', 'SOFI', 'NIO', 'RIVN', 'LUCID', 'F', 'SNAP',
                // Meme stocks - High volatility
                'GME', 'AMC', 'BBBY', 'BB', 'NOK',
                // High beta tech
                'COIN', 'ROKU', 'ZM', 'DKNG', 'UPST', 'AFRM', 'HOOD',
                // Energy - Volatile
                'XLE', 'USO', 'FANG', 'DVN', 'MRO',
                // Financial high volume
                'BAC', 'JPM', 'C', 'GS', 'WFC',
                // Retail favorites
                'PTON', 'BYND', 'TLRY', 'PLUG', 'SPCE',
                // Crypto-related
                'MARA', 'RIOT', 'MSTR', 'SQ', 'PYPL',
                // ETFs for day trading
                'SPY', 'QQQ', 'IWM', 'DIA', 'SQQQ', 'TQQQ',
                // Chinese stocks - High volatility
                'BABA', 'JD', 'PDD', 'BIDU', 'NIO', 'XPEV', 'LI'
            ];

            const scanStocks = async () => {
                setLoading(true);
                setError(null);
                const stocksData = [];

                const delay = (ms) => new Promise(resolve => setTimeout(resolve, ms));

                console.log('Starting day trading scan...');

                for (let i = 0; i < dayTradingWatchlist.length; i++) {
                    const symbol = dayTradingWatchlist[i];
                    
                    try {
                        console.log(`Scanning ${symbol}...`);
                        const response = await fetch(`https://stock-trading-api.onrender.com/api/stock/${symbol}?period=1d&interval=5m`);
                        
                        if (response.ok) {
                            const data = await response.json();
                            
                            // Calculate day trading score
                            const dayTradingScore = calculateDayTradingScore(data);
                            
                            if (dayTradingScore.isDayTradeable) {
                                stocksData.push({
                                    symbol: data.symbol,
                                    name: data.name,
                                    price: data.currentPrice,
                                    change: data.change,
                                    changePercent: data.changePercent,
                                    volume: data.volume,
                                    indicators: data.indicators,
                                    recommendation: data.recommendation,
                                    dayTradingScore: dayTradingScore
                                });
                                
                                setStocks([...stocksData]);
                            }
                        }
                        
                        // Small delay to avoid rate limiting
                        await delay(1500);
                        
                    } catch (err) {
                        console.error(`Error scanning ${symbol}:`, err);
                    }
                }

                setLoading(false);
                console.log(`Scan complete. Found ${stocksData.length} day tradeable stocks.`);
            };

            const calculateDayTradingScore = (data) => {
                const indicators = data.indicators;
                const volume = data.volume;
                const changePercent = Math.abs(data.changePercent);
                
                let score = 0;
                const signals = [];
                
                // Volume analysis (CRITICAL for day trading)
                const volumeRatio = indicators.volume_ratio || 1;
                if (volumeRatio > 2) {
                    score += 3;
                    signals.push('üî• Very High Volume');
                } else if (volumeRatio > 1.5) {
                    score += 2;
                    signals.push('üìà High Volume');
                }
                
                // Volatility (movement potential)
                if (changePercent > 3) {
                    score += 3;
                    signals.push('‚ö° High Volatility');
                } else if (changePercent > 1.5) {
                    score += 2;
                    signals.push('üìä Good Movement');
                }
                
                // RSI for entry timing
                if (indicators.rsi < 35) {
                    score += 2;
                    signals.push('üéØ Oversold - Bounce Play');
                } else if (indicators.rsi > 65) {
                    score += 2;
                    signals.push('üöÄ Momentum Play');
                }
                
                // MACD momentum
                if (indicators.macd_hist > 0 && indicators.macd > indicators.macd_signal) {
                    score += 2;
                    signals.push('üí™ Bullish Momentum');
                }
                
                // Price above moving averages (trending)
                const currentPrice = data.currentPrice;
                if (currentPrice > indicators.sma_20) {
                    score += 1;
                    signals.push('‚úÖ Above 20 SMA');
                }
                
                // ATR for stop loss planning
                const atr = indicators.atr || 0;
                if (atr > 0) {
                    const atrPercent = (atr / currentPrice) * 100;
                    if (atrPercent > 2) {
                        signals.push(`üìè ATR: ${atrPercent.toFixed(1)}%`);
                    }
                }
                
                // Heat level
                let heatLevel = 'moderate';
                if (score >= 8) {
                    heatLevel = 'hot';
                } else if (score >= 5) {
                    heatLevel = 'warm';
                }
                
                return {
                    score: score,
                    heatLevel: heatLevel,
                    signals: signals,
                    isDayTradeable: score >= 4, // Minimum threshold
                    volumeRatio: volumeRatio,
                    atr: atr,
                    stopLoss: currentPrice - (atr * 1.5), // Suggested stop loss
                    target: currentPrice + (atr * 2) // Suggested target
                };
            };

            const getFilteredStocks = () => {
                if (filter === 'all') return stocks;
                return stocks.filter(stock => stock.dayTradingScore.heatLevel === filter);
            };

            const getStats = () => {
                return {
                    total: stocks.length,
                    hot: stocks.filter(s => s.dayTradingScore.heatLevel === 'hot').length,
                    warm: stocks.filter(s => s.dayTradingScore.heatLevel === 'warm').length,
                    avgVolume: stocks.length > 0 
                        ? (stocks.reduce((sum, s) => sum + (s.dayTradingScore.volumeRatio || 1), 0) / stocks.length).toFixed(1)
                        : 0
                };
            };

            const handleStockClick = (symbol) => {
                window.open(`index.html?symbol=${symbol}`, '_blank');
            };

            const filteredStocks = getFilteredStocks();
            const stats = getStats();

            // Sort by score descending
            filteredStocks.sort((a, b) => b.dayTradingScore.score - a.dayTradingScore.score);

            return (
                <div className="container">
                    <div className="header">
                        <div className="header-content">
                            <div>
                                <h1>‚ö° Day Trading Scanner</h1>
                                <p>Real-time intraday opportunities with high volume and volatility</p>
                            </div>
                            <div className="nav-buttons">
                                <a href="dashboard.html" className="nav-btn">üéØ Dashboard</a>
                                <a href="potential.html" className="nav-btn">üìä Potential</a>
                                <a href="index.html" className="nav-btn">üìà Analysis</a>
                            </div>
                        </div>

                        <div className="criteria">
                            <h3>Day Trading Criteria:</h3>
                            <div className="criteria-list">
                                <div className="criteria-item">High volume (1.5x+ average)</div>
                                <div className="criteria-item">Price movement {'>'} 1.5% today</div>
                                <div className="criteria-item">RSI extremes (oversold/overbought)</div>
                                <div className="criteria-item">Strong MACD momentum</div>
                                <div className="criteria-item">Tight ATR for stop losses</div>
                                <div className="criteria-item">5-minute interval analysis</div>
                            </div>
                        </div>

                        <div className="controls">
                            <button 
                                className="scan-btn" 
                                onClick={scanStocks}
                                disabled={loading}
                            >
                                {loading ? 'Scanning...' : 'üîç Scan for Day Trades'}
                            </button>

                            {stocks.length > 0 && (
                                <div className="filter-buttons">
                                    <button 
                                        className={`filter-btn ${filter === 'all' ? 'active' : ''}`}
                                        onClick={() => setFilter('all')}
                                    >
                                        All ({stocks.length})
                                    </button>
                                    <button 
                                        className={`filter-btn ${filter === 'hot' ? 'active' : ''}`}
                                        onClick={() => setFilter('hot')}
                                    >
                                        üî• Hot ({stats.hot})
                                    </button>
                                    <button 
                                        className={`filter-btn ${filter === 'warm' ? 'active' : ''}`}
                                        onClick={() => setFilter('warm')}
                                    >
                                        ‚ö° Warm ({stats.warm})
                                    </button>
                                    <button 
                                        className={`filter-btn ${filter === 'moderate' ? 'active' : ''}`}
                                        onClick={() => setFilter('moderate')}
                                    >
                                        üìä Moderate ({stocks.length - stats.hot - stats.warm})
                                    </button>
                                </div>
                            )}
                        </div>
                    </div>

                    {error && (
                        <div className="error">
                            <strong>Error:</strong> {error}
                        </div>
                    )}

                    {loading && (
                        <div className="loading">
                            <div className="spinner"></div>
                            Scanning stocks for day trading opportunities...
                        </div>
                    )}

                    {!loading && stocks.length > 0 && (
                        <>
                            <div className="stats-bar">
                                <div className="stat-item">
                                    <div className="stat-value">{stats.total}</div>
                                    <div className="stat-label">Day Tradeable</div>
                                </div>
                                <div className="stat-item">
                                    <div className="stat-value" style={{color: '#dc3545'}}>{stats.hot}</div>
                                    <div className="stat-label">Hot Plays</div>
                                </div>
                                <div className="stat-item">
                                    <div className="stat-value" style={{color: '#ffc107'}}>{stats.warm}</div>
                                    <div className="stat-label">Warm Plays</div>
                                </div>
                                <div className="stat-item">
                                    <div className="stat-value">{stats.avgVolume}x</div>
                                    <div className="stat-label">Avg Volume Ratio</div>
                                </div>
                            </div>

                            <div className="stocks-grid">
                                {filteredStocks.map(stock => (
                                    <div 
                                        key={stock.symbol} 
                                        className={`stock-card ${stock.dayTradingScore.heatLevel}`}
                                        onClick={() => handleStockClick(stock.symbol)}
                                    >
                                        <div className="stock-header">
                                            <div>
                                                <div className="stock-symbol">{stock.symbol}</div>
                                                <div className="stock-name">{stock.name}</div>
                                            </div>
                                            <div className={`heat-badge ${stock.dayTradingScore.heatLevel}`}>
                                                {stock.dayTradingScore.heatLevel === 'hot' ? 'üî• HOT' : 
                                                 stock.dayTradingScore.heatLevel === 'warm' ? '‚ö° WARM' : 'üìä Active'}
                                            </div>
                                        </div>

                                        <div className="stock-price">${stock.price?.toFixed(2)}</div>
                                        <div className={`stock-change ${stock.change >= 0 ? 'positive' : 'negative'}`}>
                                            {stock.change >= 0 ? '‚ñ≤' : '‚ñº'} {stock.changePercent?.toFixed(2)}% Today
                                        </div>

                                        <div className="metrics">
                                            <div className="metric">
                                                <div className="metric-label">Volume</div>
                                                <div className="metric-value">{stock.dayTradingScore.volumeRatio.toFixed(1)}x</div>
                                            </div>
                                            <div className="metric">
                                                <div className="metric-label">Score</div>
                                                <div className="metric-value">{stock.dayTradingScore.score}/10</div>
                                            </div>
                                            <div className="metric">
                                                <div className="metric-label">Stop Loss</div>
                                                <div className="metric-value">${stock.dayTradingScore.stopLoss.toFixed(2)}</div>
                                            </div>
                                            <div className="metric">
                                                <div className="metric-label">Target</div>
                                                <div className="metric-value" style={{color: '#28a745'}}>
                                                    ${stock.dayTradingScore.target.toFixed(2)}
                                                </div>
                                            </div>
                                        </div>

                                        <div className="signals">
                                            <div className="signals-title">Day Trading Signals:</div>
                                            {stock.dayTradingScore.signals.map((signal, idx) => (
                                                <span key={idx} className="signal-tag">{signal}</span>
                                            ))}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </>
                    )}

                    {!loading && stocks.length === 0 && (
                        <div className="empty-state">
                            <h2>üìä Ready to Scan</h2>
                            <p>Click "Scan for Day Trades" to find high-volume, volatile stocks perfect for day trading</p>
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.render(<DayTradingScanner />, document.getElementById('root'));
    </script>
</body>
</html>
